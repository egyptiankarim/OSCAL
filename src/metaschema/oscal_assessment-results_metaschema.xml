<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../build/metaschema/toolchains/xslt-M4/validate/metaschema-check.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<METASCHEMA xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xmlns="http://csrc.nist.gov/ns/oscal/metaschema/1.0"
            xsi:schemaLocation="http://csrc.nist.gov/ns/oscal/metaschema/1.0 ../../build/metaschema/toolchains/xslt-M4/validate/metaschema.xsd">
   <schema-name>OSCAL Assessment Results Format</schema-name>
   <schema-version>1.0.0-milestone3</schema-version>
   <short-name>oscal-ar</short-name>
   <namespace>http://csrc.nist.gov/ns/oscal/1.0</namespace>
   <remarks>
      <p>The OSCAL assessment results format is used to describe the information typically provided by an assessor following an assessment.</p>
      <p>The root of the OSCAL assessment results format is <code>assessment-results</code>.</p>
   </remarks>
   <!-- IMPORT STATEMENTS -->
   <import href="oscal_metadata_metaschema.xml"/>
   <import href="oscal_implementation-common_metaschema.xml"/>
   <import href="oscal_assessment-common_metaschema.xml"/>
   <!-- TOP LEVEL ASSEMBLY -->
   <define-assembly name="assessment-results">
      <formal-name>Security Assessment Results (SAR)</formal-name>
      <description>Security assessment results, such as those provided by a FedRAMP assessor in the FedRAMP Security Assessment Report.</description>
      <root-name>assessment-results</root-name>
      <define-flag name="uuid" required="yes" as-type="uuid">
         <formal-name>Assessment Results Universally Unique Identifier</formal-name>
         <description>Uniquely identifies this assessment results file. This UUID must be changed each time the content of the results changes.</description>
      </define-flag>
      <model>
         <assembly ref="metadata" min-occurs="1" max-occurs="1"/>
         <assembly ref="import-ap" min-occurs="1" max-occurs="1">
            <remarks>
               <p>Used by the SAR to import information about the original plan for assessing the system.</p>
            </remarks>
         </assembly>
         <assembly ref="objectives" min-occurs="1" max-occurs="1"/>
         <assembly ref="assessment-subjects" min-occurs="0" max-occurs="1"/>
         <assembly ref="assets" min-occurs="0" max-occurs="1"/>
         <assembly ref="assessment-activities" min-occurs="0" max-occurs="1"/>
         <assembly ref="results" min-occurs="1" max-occurs="unbounded">
            <group-as name="results_group" in-json="ARRAY"/>
         </assembly>
         <assembly ref="back-matter" min-occurs="0" max-occurs="1"/>
      </model>
   </define-assembly>

   <!-- Assessment Plan Import -->
   <define-assembly name="import-ap">
      <formal-name>Import Assessment Plan</formal-name>
      <description>Used by assessment-results to import information about the original plan for assessing the system.</description>
      <define-flag name="href" required="yes" as-type="uri-reference">
         <formal-name>Assessment Plan Reference</formal-name>
         <description>>A resolvable URL reference to the assessment plan governing the assessment activities.</description>
         <remarks>
            <p>The value of the <code>href</code> can be an internet resource, or a local reference using a fragment e.g. #fragment that points to a <code>back-matter</code> <code>resource</code> in the same document.</p>
            <!-- TODO: Add a link to "within the scope of the containing OSCAL document" to point to documentation of identification scopes" -->
            <p>If a local reference using a fragment is used, this will be indicated by a fragment "#" followed by an identifier which references an identified <code>resource</code> in the document's <code>back-matter</code> or another object that is within the scope of the containing OSCAL document.</p>
            <p>If an internet resource is used, the <code>href</code> value will be an absolute or relative URI pointing to the location of the referenced resource. A relative URI will be resolved relative to the location of the document containing the link.</p>
         </remarks>
      </define-flag>
      <model>
         <field ref="remarks"
            in-xml="WITH_WRAPPER"
            min-occurs="0"
            max-occurs="1"/>
      </model>
   </define-assembly>

   <define-assembly name="assessment-subjects">
      <formal-name>Subject of Assessment</formal-name>
      <description>Identifies system elements being assessed, such as components, inventory items, and locations. In the assessment plan, this identifies the planned assessment subject. In the assessment results this is the actual assessment subject, and reflects any changes from the plan.</description>
      <model>
         <assembly ref="include-subject" min-occurs="1" max-occurs="unbounded">
            <group-as name="includes" in-json="ARRAY"/>
         </assembly>
         <assembly ref="exclude-subject" min-occurs="0" max-occurs="unbounded">
            <group-as name="excludes" in-json="ARRAY"/>
         </assembly>
         <assembly ref="local-definitions" min-occurs="0" max-occurs="1"/>
         <field ref="remarks"
                in-xml="WITH_WRAPPER"
                min-occurs="0"
                max-occurs="1"/>
      </model>
   </define-assembly>
   <define-assembly name="local-definitions">
      <formal-name>Local Definitions</formal-name>
      <description>Allows control objectives, users, components, and inventory-items to be defined within the assessment plan or assessment results for circumstances where they are not appropriately defined in the SSP. NOTE: Use the assessment plan or assessment results metadata to define additional locations if needed.</description>
      <model>
         <assembly ref="component" min-occurs="0" max-occurs="unbounded">
            <group-as name="components" in-json="BY_KEY"/>
            <remarks>
               <p>Used to add any components, not defined via the System Security Plan (AR-&gt;AP-&gt;SSP)</p>
            </remarks>
         </assembly>
         <assembly ref="inventory-item" min-occurs="0" max-occurs="unbounded">
            <group-as name="inventory-items" in-json="BY_KEY"/>
            <remarks>
               <p>Used to add any inventory-items, not defined via the System Security Plan (AR-&gt;AP-&gt;SSP)</p>
            </remarks>
         </assembly>
         <assembly ref="user" min-occurs="0" max-occurs="unbounded">
            <group-as name="users" in-json="BY_KEY"/>
            <remarks>
               <p>Used to add any users, not defined via the System Security Plan (AR-&gt;AP-&gt;SSP)</p>
            </remarks>
         </assembly>
         <field ref="remarks"
                in-xml="WITH_WRAPPER"
                min-occurs="0"
                max-occurs="1"/>
      </model>
   </define-assembly>
</METASCHEMA>
