<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../build/metaschema/toolchains/xslt-M4/validate/metaschema-check.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<METASCHEMA xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns="http://csrc.nist.gov/ns/oscal/metaschema/1.0"
   xsi:schemaLocation="http://csrc.nist.gov/ns/oscal/metaschema/1.0 ../../build/metaschema/toolchains/xslt-M4/validate/metaschema.xsd">
   <schema-name>OSCAL Plan of Action and Milestones (POA&amp;M) Format</schema-name>
   <schema-version>1.0.0-milestone3</schema-version>
   <short-name>oscal-poam</short-name>
   <namespace>http://csrc.nist.gov/ns/oscal/1.0</namespace>
   <remarks>
      <p>The OSCAL Plan of Action and Milestones (POA&amp;M) format is used to describe the information typically provided by an assessor during the preparation for an assessment.</p>
      <p>The root of the OSCAL Plan of Action and Milestones (POA&amp;M) format is <code>plan-action-milestones</code>.</p>
   </remarks>
   <!-- IMPORT STATEMENTS -->
   <import href="oscal_metadata_metaschema.xml"/>
   <import href="oscal_implementation-common_metaschema.xml"/>
   <import href="oscal_assessment-common_metaschema.xml"/>
   <!-- TOP LEVEL ASSEMBLY -->
   <define-assembly name="plan-of-action-and-milestones">
      <formal-name>Plan of Action and Milestones (POA&amp;M)</formal-name>
      <description>A plan of action and milestones, such as those required by FedRAMP.</description>
      <root-name>plan-of-action-and-milestones</root-name>
      <define-flag name="uuid" required="yes" as-type="uuid">
         <formal-name>POA&amp;M Universally Unique Identifier</formal-name>
         <description>Uniquely identifies this POA&amp;M. This UUID must be changed each time the content of the POA&amp;M changes.</description>
      </define-flag>
      <model>
         <assembly ref="metadata" min-occurs="1" max-occurs="1"/>
         <assembly ref="import-ssp" min-occurs="0" max-occurs="1">
            <remarks>
               <p>Used by the POA&amp;M to import information about the system.</p>
            </remarks>
         </assembly>
         <field ref="system-id" min-occurs="0" max-occurs="1"/>
         <assembly ref="local-definitions" min-occurs="0" max-occurs="1"/>
         <assembly ref="poam-items" min-occurs="1" max-occurs="1"/>
         <assembly ref="back-matter" min-occurs="0" max-occurs="1"/>
      </model>
      <remarks>
         <p>Either an OSCAL-based SSP must be imported, or a unique system-id must be specified. Both may be present.</p>
      </remarks>
   </define-assembly>
   <define-assembly name="local-definitions">
      <formal-name>Local Definitions</formal-name>
      <description>Allows components, and inventory-items to be defined within the POA&amp;M for circumstances where no OSCAL-based SSP exists, or is not delivered with the POA&amp;M.</description>
      <model>
         <assembly ref="system-component" min-occurs="0" max-occurs="unbounded">
            <use-name>component</use-name>
            <group-as name="components" in-json="BY_KEY"/>
            <remarks>
               <p>Used to add any components, not defined via the System Security Plan (AR-&gt;AP-&gt;SSP)</p>
            </remarks>
         </assembly>
         <assembly ref="inventory-item" min-occurs="0" max-occurs="unbounded">
            <group-as name="inventory-items" in-json="BY_KEY"/>
            <remarks>
               <p>Used to add any inventory-items, not defined via the System Security Plan (AR-&gt;AP-&gt;SSP)</p>
            </remarks>
         </assembly>
         <field ref="remarks"
                in-xml="WITH_WRAPPER"
                min-occurs="0"
                max-occurs="1"/>
      </model>
   </define-assembly>
   
   <define-assembly name="poam-items">
      <formal-name>POA&amp;M Items</formal-name>
      <description>This identifies initial and residual risks, deviations, and disposition.</description>
      <model>
         <define-field name="title" min-occurs="1" max-occurs="1" as-type="markup-line">
            <formal-name>POA&amp;M Items Title</formal-name>
            <description>The title this collection of POA&amp;M items.</description>
         </define-field>
         <!-- CHANGE: Added WITH_WRAPPER to description-->
         <!-- CHANGE: Made description optional-->
         <define-field name="description" min-occurs="0" max-occurs="1" in-xml="WITH_WRAPPER" as-type="markup-multiline">
            <formal-name>POA&amp;M Items Description</formal-name>
            <description>A human-readable description of this collection of POA&amp;M items.</description>
         </define-field>

         <define-field name="prop" min-occurs="0" max-occurs="unbounded">
            <formal-name>POA&amp;M Items Property</formal-name>
            <description>Provided as means of extending the OSCAL syntax.</description>
            <use-name>prop</use-name>
            <json-value-key>value</json-value-key>
            <group-as name="properties" in-json="ARRAY"/>
            <define-flag name="name" required="yes">
               <formal-name>Property Name</formal-name>
               <description>A textual label that identifies a specific attribute, characteristic, or quality of the property's containing object.</description>
            </define-flag>
            <define-flag name="uuid" required="no" as-type="uuid">
               <formal-name>POA&amp;M Items Property Universally Unique Identifier</formal-name>
               <description>Uniquely identifies the property of this collection of POA&amp;M items. This UUID may be referenced elsewhere in an OSCAL document when refering to this information. A UUID should be consistantly used for a given property across revisions of the document.</description>
            </define-flag>

            <define-flag name="ns" as-type="uri">
               <!-- CHANGED: data type to uri -->
               <formal-name>Property Namespace</formal-name>
               <description>A namespace qualifying the property's name. This allows different organizations to associate distinct semantics with the same name.</description>
               <remarks>
                  <p>Provides a means to segment the value space for the <code>name</code>, so that different organizations and individuals can assert control over the allowed names and associated values used in a property. This allows the semantics associated with a given name/value pair to be defined on an organization-by-organization basis.</p>
                  <p>An organization MUST use a URI that they have control over. e.g., a domain registered to the organization in a URI, a registered uniform resource names (URN) namespace.</p>
                  <p>When a <code>ns</code> is not provided, its value should be assumed to be <code>http://csrc.nist.gov/ns/oscal</code> and the name should be a name defined by the associated OSCAL model.</p>
               </remarks>
            </define-flag>
            
            <define-flag name="class" as-type="NCName">
               <formal-name>Property Class</formal-name>
               <description>A textual label that provides a sub-type or characterization of the property's <code>name</code>. This can be used to further distinguish or discriminate between the semantics of multiple properties of the same object with the same <code>name</code> and <code>ns</code>.</description>
               <remarks>
                  <p>A <code>class</code> can be used in validation rules to express extra constraints over named items of a specific <code>class</code> value.</p>
               </remarks>
            </define-flag>


         </define-field>
         <assembly ref="annotation" min-occurs="0" max-occurs="unbounded">
            <group-as name="annotations" in-json="ARRAY"/>
            <remarks>
               <p>Provided as means of extending the OSCAL syntax.</p>
            </remarks>
         </assembly>
         <define-field name="start"
                       as-type="dateTime-with-timezone"
                       min-occurs="1"
                       max-occurs="1">
            <formal-name>start field</formal-name>
            <description>Date/time stamp identifying the start of the evidence collection reflected in these results.</description>
         </define-field>
         <define-field name="end"
                       as-type="dateTime-with-timezone"
                       min-occurs="0"
                       max-occurs="1">
            <formal-name>end field</formal-name>
            <description>Date/time stamp identifying the end of the evidence collection reflected in these results. In a continuous monitoring scenario, this may be omitted or contain the same value as start if appropriate.</description>
         </define-field>
         <assembly ref="poam-item" min-occurs="1" max-occurs="unbounded">
            <group-as name="poam-item-group" in-json="ARRAY"/>
         </assembly>
         <field ref="remarks"
                in-xml="WITH_WRAPPER"
                min-occurs="0"
                max-occurs="1"/>
      </model>
   </define-assembly>
   
   <define-assembly name="poam-item">
      <formal-name>POA&amp;M Item</formal-name>
      <description>Describes an individual POA&amp;M item.</description>
      <define-flag name="uuid" required="no" as-type="uuid">
         <formal-name>POA&amp;M Item Universally Unique Identifier</formal-name>
         <description>Uniquely identifies the POA&amp;M entry. This UUID may be referenced elsewhere in an OSCAL document when refering to this information. A UUID should be consistantly used for a given POA&amp;M item across revisions of the document.</description>
      </define-flag>
      <model>
         <define-field name="title" min-occurs="1" max-occurs="1" as-type="markup-line">
            <formal-name>POA&amp;M Item Title</formal-name>
            <description>The title or name for this POA&amp;M item .</description>
         </define-field>
         <!-- CHANGE: Added WITH_WRAPPER to description-->
         <define-field name="description" min-occurs="1" max-occurs="1" in-xml="WITH_WRAPPER" as-type="markup-multiline">
            <formal-name>POA&amp;M Item Description</formal-name>
            <description>A human-readable description of POA&amp;M item.</description>
         </define-field>
         <define-field name="prop" min-occurs="0" max-occurs="unbounded">
            <formal-name>prop field</formal-name>
            <description>Provided as means of extending the OSCAL syntax.</description>
            <json-value-key>value</json-value-key>
            <group-as name="properties" in-json="ARRAY"/>
            <define-flag name="name" required="yes">
               <formal-name>name flag</formal-name>
               <description>name flag ... </description>
            </define-flag>
            <define-flag name="uuid" required="no" as-type="uuid">
               <formal-name>POA&amp;M Item Property Universally Unique Identifier</formal-name>
               <description>Uniquely identifies the property of this POA&amp;M item. This UUID may be referenced elsewhere in an OSCAL document when refering to this information. A UUID should be consistantly used for a given property across revisions of the document.</description>
            </define-flag>
            
            <define-flag name="ns" as-type="uri">
               <!-- CHANGED: data type to uri -->
               <formal-name>Property Namespace</formal-name>
               <description>A namespace qualifying the property's name. This allows different organizations to associate distinct semantics with the same name.</description>
               <remarks>
                  <p>Provides a means to segment the value space for the <code>name</code>, so that different organizations and individuals can assert control over the allowed names and associated values used in a property. This allows the semantics associated with a given name/value pair to be defined on an organization-by-organization basis.</p>
                  <p>An organization MUST use a URI that they have control over. e.g., a domain registered to the organization in a URI, a registered uniform resource names (URN) namespace.</p>
                  <p>When a <code>ns</code> is not provided, its value should be assumed to be <code>http://csrc.nist.gov/ns/oscal</code> and the name should be a name defined by the associated OSCAL model.</p>
               </remarks>
            </define-flag>
            
            <define-flag name="class" as-type="NCName">
               <formal-name>Property Class</formal-name>
               <description>A textual label that provides a sub-type or characterization of the property's <code>name</code>. This can be used to further distinguish or discriminate between the semantics of multiple properties of the same object with the same <code>name</code> and <code>ns</code>.</description>
               <remarks>
                  <p>A <code>class</code> can be used in validation rules to express extra constraints over named items of a specific <code>class</code> value.</p>
               </remarks>
            </define-flag>
            
         </define-field>
         <assembly ref="annotation" min-occurs="0" max-occurs="unbounded">
            <group-as name="annotations" in-json="ARRAY"/>
            <remarks>
               <p>Provided as means of extending the OSCAL syntax.</p>
            </remarks>
         </assembly>
         <define-field name="collected"
                       as-type="dateTime-with-timezone"
                       min-occurs="1"
                       max-occurs="1">
            <formal-name>collected field</formal-name>
            <description>Date/time stamp identifying when the finding information was collected.</description>
         </define-field>
         <define-field name="expires"
                       as-type="dateTime-with-timezone"
                       min-occurs="0"
                       max-occurs="1">
            <formal-name>expires field</formal-name>
            <description>Date/time identifying when the finding information is out-of-date and no longer valid. Typically used with continuous assessment scenarios.</description>
         </define-field>
         <assembly ref="objective-status" min-occurs="0" max-occurs="1"/>
         <field ref="implementation-statement-uuid" min-occurs="0" max-occurs="1"/>
         <assembly ref="observation" min-occurs="0" max-occurs="unbounded">
            <group-as name="observations" in-json="ARRAY"/>
         </assembly>
         <field ref="threat-id" min-occurs="0" max-occurs="unbounded">
            <group-as name="threat-ids" in-json="ARRAY"/>
         </field>
         <assembly ref="risk" min-occurs="0" max-occurs="unbounded">
            <group-as name="risks" in-json="ARRAY"/>
         </assembly>
         <define-field name="party-uuid"
                       as-type="uuid"
                       min-occurs="0"
                       max-occurs="unbounded">
            <formal-name>party-uuid field</formal-name>
            <description>The person who collected the evidence or made the observation.</description>
            <group-as name="party-uuids" in-json="ARRAY"/>
         </define-field>
         <field ref="remarks"
                in-xml="WITH_WRAPPER"
                min-occurs="0"
                max-occurs="1"/>
      </model>
   </define-assembly>
</METASCHEMA>
